function dx = systemCTN_rand(in)
x=in(1:4);
tau=in(5);

J0= 4.5e-8;
J1= 6.7e-3;
J2= 0.9375;
R0=0.025;
R1= 0.124;
M1= 0.65;
M2= 30;
L= 0.5;
b_e=1.85e-3;
g=9.81;

dx(1,1) = x(2);
dx(2,1) = -(R1*(L*M2*x(4)^2*sin(x(3)) - (L*M2*cos(x(3))*(tau + L*sin(x(3))*(M2*g - L*M2*x(4)*cos(x(3))) + L^2*M2*x(4)^2*cos(x(3))*sin(x(3))))/(J2*((M2*L^2*cos(x(3))^2 + M2*L^2*sin(x(3))^2)/J2 + 1))) + (R1*(R0*tau - R1*b_e*x(2)))/R0^2)/(J1*((R1*(M1*R1 + M2*R1) + (J0*R1^2)/R0^2)/J1 + 1)*((L^2*M2^2*R1^2*cos(x(3))^2)/(J1*J2*((R1*(M1*R1 + M2*R1) + (J0*R1^2)/R0^2)/J1 + 1)*((M2*L^2*cos(x(3))^2 + M2*L^2*sin(x(3))^2)/J2 + 1)) - 1));
dx(3,1) = x(4);
dx(4,1) = -(tau + L*sin(x(3))*(M2*g - L*M2*x(4)*cos(x(3))) + L*cos(x(3))*(L*M2*x(4)^2*sin(x(3)) - (M2*R1*((R1*(R0*tau - R1*b_e*x(2)))/R0^2 + L*M2*R1*x(4)^2*sin(x(3))))/(J1*((R1*(M1*R1 + M2*R1) + (J0*R1^2)/R0^2)/J1 + 1))))/(J2*((L^2*M2^2*R1^2*cos(x(3))^2)/(J1*J2*((R1*(M1*R1 + M2*R1) + (J0*R1^2)/R0^2)/J1 + 1)*((M2*L^2*cos(x(3))^2 + M2*L^2*sin(x(3))^2)/J2 + 1)) - 1)*((M2*L^2*cos(x(3))^2 + M2*L^2*sin(x(3))^2)/J2 + 1))+rand;